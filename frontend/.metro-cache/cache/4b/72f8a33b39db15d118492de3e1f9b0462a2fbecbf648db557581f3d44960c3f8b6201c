{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":160},"end":{"line":3,"column":53,"index":213}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":214},"end":{"line":4,"column":34,"index":248}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/contexts/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _expoRouter = require(_dependencyMap[2], \"expo-router\");\n  var _servicesApi = require(_dependencyMap[3], \"../services/api\");\n  var api = _interopDefault(_servicesApi);\n  var _reactJsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const router = (0, _expoRouter.useRouter)();\n    const segments = (0, _expoRouter.useSegments)();\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, []);\n    (0, _react.useEffect)(() => {\n      if (isLoading) return;\n      const inAuthGroup = segments[0] === '(tabs)';\n      if (!user && inAuthGroup) {\n        router.replace('/login');\n      } else if (user && !inAuthGroup && segments[0] !== 'index') {\n        router.replace('/(tabs)/home');\n      }\n    }, [user, segments, isLoading]);\n    const checkAuth = async () => {\n      try {\n        const sessionToken = await AsyncStorage.default.getItem('session_token');\n        if (sessionToken) {\n          api.default.defaults.headers.common['Authorization'] = `Bearer ${sessionToken}`;\n          const response = await api.default.get('/auth/me');\n          setUser(response.data);\n        }\n      } catch (error) {\n        console.log('Auth check failed:', error);\n        await AsyncStorage.default.removeItem('session_token');\n        delete api.default.defaults.headers.common['Authorization'];\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const processSessionId = async sessionId => {\n      setIsLoading(true);\n      try {\n        const response = await api.default.post('/auth/session', {\n          session_id: sessionId\n        });\n        if (response.data.success) {\n          const {\n            user: userData,\n            session_token\n          } = response.data;\n          await AsyncStorage.default.setItem('session_token', session_token);\n          api.default.defaults.headers.common['Authorization'] = `Bearer ${session_token}`;\n          setUser(userData);\n          router.replace('/(tabs)/home');\n        }\n      } catch (error) {\n        console.error('Session exchange failed:', error);\n        router.replace('/login');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = () => {\n      router.push('/login');\n    };\n    const logout = async () => {\n      try {\n        await api.default.post('/auth/logout');\n      } catch (error) {\n        console.log('Logout API error:', error);\n      }\n      await AsyncStorage.default.removeItem('session_token');\n      delete api.default.defaults.headers.common['Authorization'];\n      setUser(null);\n      router.replace('/login');\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        logout,\n        processSessionId\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 5\n    }, this);\n  }\n  function useAuth() {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n});","lineCount":117,"map":[[13,2,24,0,"exports"],[13,9,24,0],[13,10,24,0,"AuthProvider"],[13,22,24,0],[13,25,24,0,"AuthProvider"],[13,37,24,0],[14,2,111,0,"exports"],[14,9,111,0],[14,10,111,0,"useAuth"],[14,17,111,0],[14,20,111,0,"useAuth"],[14,27,111,0],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,3,0],[18,6,3,0,"_expoRouter"],[18,17,3,0],[18,20,3,0,"require"],[18,27,3,0],[18,28,3,0,"_dependencyMap"],[18,42,3,0],[19,2,4,0],[19,6,4,0,"_servicesApi"],[19,18,4,0],[19,21,4,0,"require"],[19,28,4,0],[19,29,4,0,"_dependencyMap"],[19,43,4,0],[20,2,4,0],[20,6,4,0,"api"],[20,9,4,0],[20,12,4,0,"_interopDefault"],[20,27,4,0],[20,28,4,0,"_servicesApi"],[20,40,4,0],[21,2,4,34],[21,6,4,34,"_reactJsxDevRuntime"],[21,25,4,34],[21,28,4,34,"require"],[21,35,4,34],[21,36,4,34,"_dependencyMap"],[21,50,4,34],[22,2,22,0],[22,8,22,6,"AuthContext"],[22,19,22,17],[22,35,22,20],[22,39,22,20,"createContext"],[22,45,22,33],[22,46,22,33,"createContext"],[22,59,22,33],[22,61,22,63,"undefined"],[22,70,22,72],[22,71,22,73],[23,2,24,7],[23,11,24,16,"AuthProvider"],[23,23,24,28,"AuthProvider"],[23,24,24,29],[24,4,24,31,"children"],[25,2,24,65],[25,3,24,66],[25,5,24,68],[26,4,25,2],[26,10,25,8],[26,11,25,9,"user"],[26,15,25,13],[26,17,25,15,"setUser"],[26,24,25,22],[26,25,25,23],[26,28,25,26],[26,32,25,26,"useState"],[26,38,25,34],[26,39,25,34,"useState"],[26,47,25,34],[26,49,25,48],[26,53,25,52],[26,54,25,53],[27,4,26,2],[27,10,26,8],[27,11,26,9,"isLoading"],[27,20,26,18],[27,22,26,20,"setIsLoading"],[27,34,26,32],[27,35,26,33],[27,38,26,36],[27,42,26,36,"useState"],[27,48,26,44],[27,49,26,44,"useState"],[27,57,26,44],[27,59,26,45],[27,63,26,49],[27,64,26,50],[28,4,27,2],[28,10,27,8,"router"],[28,16,27,14],[28,19,27,17],[28,23,27,17,"useRouter"],[28,34,27,26],[28,35,27,26,"useRouter"],[28,44,27,26],[28,46,27,27],[28,47,27,28],[29,4,28,2],[29,10,28,8,"segments"],[29,18,28,16],[29,21,28,19],[29,25,28,19,"useSegments"],[29,36,28,30],[29,37,28,30,"useSegments"],[29,48,28,30],[29,50,28,31],[29,51,28,32],[30,4,30,2],[30,8,30,2,"useEffect"],[30,14,30,11],[30,15,30,11,"useEffect"],[30,24,30,11],[30,26,30,12],[30,32,30,18],[31,6,31,4,"checkAuth"],[31,15,31,13],[31,16,31,14],[31,17,31,15],[32,4,32,2],[32,5,32,3],[32,7,32,5],[32,9,32,7],[32,10,32,8],[33,4,34,2],[33,8,34,2,"useEffect"],[33,14,34,11],[33,15,34,11,"useEffect"],[33,24,34,11],[33,26,34,12],[33,32,34,18],[34,6,35,4],[34,10,35,8,"isLoading"],[34,19,35,17],[34,21,35,19],[35,6,37,4],[35,12,37,10,"inAuthGroup"],[35,23,37,21],[35,26,37,24,"segments"],[35,34,37,32],[35,35,37,33],[35,36,37,34],[35,37,37,35],[35,42,37,40],[35,50,37,48],[36,6,39,4],[36,10,39,8],[36,11,39,9,"user"],[36,15,39,13],[36,19,39,17,"inAuthGroup"],[36,30,39,28],[36,32,39,30],[37,8,40,6,"router"],[37,14,40,12],[37,15,40,13,"replace"],[37,22,40,20],[37,23,40,21],[37,31,40,29],[37,32,40,30],[38,6,41,4],[38,7,41,5],[38,13,41,11],[38,17,41,15,"user"],[38,21,41,19],[38,25,41,23],[38,26,41,24,"inAuthGroup"],[38,37,41,35],[38,41,41,39,"segments"],[38,49,41,47],[38,50,41,48],[38,51,41,49],[38,52,41,50],[38,57,41,55],[38,64,41,62],[38,66,41,64],[39,8,42,6,"router"],[39,14,42,12],[39,15,42,13,"replace"],[39,22,42,20],[39,23,42,21],[39,37,42,35],[39,38,42,36],[40,6,43,4],[41,4,44,2],[41,5,44,3],[41,7,44,5],[41,8,44,6,"user"],[41,12,44,10],[41,14,44,12,"segments"],[41,22,44,20],[41,24,44,22,"isLoading"],[41,33,44,31],[41,34,44,32],[41,35,44,33],[42,4,46,2],[42,10,46,8,"checkAuth"],[42,19,46,17],[42,22,46,20],[42,28,46,20,"checkAuth"],[42,29,46,20],[42,34,46,32],[43,6,47,4],[43,10,47,8],[44,8,48,6],[44,14,48,12,"sessionToken"],[44,26,48,24],[44,29,48,27],[44,35,48,33,"AsyncStorage"],[44,47,48,45],[44,48,48,45,"default"],[44,55,48,45],[44,56,48,46,"getItem"],[44,63,48,53],[44,64,48,54],[44,79,48,69],[44,80,48,70],[45,8,50,6],[45,12,50,10,"sessionToken"],[45,24,50,22],[45,26,50,24],[46,10,51,8,"api"],[46,13,51,11],[46,14,51,11,"default"],[46,21,51,11],[46,22,51,12,"defaults"],[46,30,51,20],[46,31,51,21,"headers"],[46,38,51,28],[46,39,51,29,"common"],[46,45,51,35],[46,46,51,36],[46,61,51,51],[46,62,51,52],[46,65,51,55],[46,75,51,65,"sessionToken"],[46,87,51,77],[46,89,51,79],[47,10,53,8],[47,16,53,14,"response"],[47,24,53,22],[47,27,53,25],[47,33,53,31,"api"],[47,36,53,34],[47,37,53,34,"default"],[47,44,53,34],[47,45,53,35,"get"],[47,48,53,38],[47,49,53,39],[47,59,53,49],[47,60,53,50],[48,10,54,8,"setUser"],[48,17,54,15],[48,18,54,16,"response"],[48,26,54,24],[48,27,54,25,"data"],[48,31,54,29],[48,32,54,30],[49,8,55,6],[50,6,56,4],[50,7,56,5],[50,8,56,6],[50,15,56,13,"error"],[50,20,56,18],[50,22,56,20],[51,8,57,6,"console"],[51,15,57,13],[51,16,57,14,"log"],[51,19,57,17],[51,20,57,18],[51,40,57,38],[51,42,57,40,"error"],[51,47,57,45],[51,48,57,46],[52,8,58,6],[52,14,58,12,"AsyncStorage"],[52,26,58,24],[52,27,58,24,"default"],[52,34,58,24],[52,35,58,25,"removeItem"],[52,45,58,35],[52,46,58,36],[52,61,58,51],[52,62,58,52],[53,8,59,6],[53,15,59,13,"api"],[53,18,59,16],[53,19,59,16,"default"],[53,26,59,16],[53,27,59,17,"defaults"],[53,35,59,25],[53,36,59,26,"headers"],[53,43,59,33],[53,44,59,34,"common"],[53,50,59,40],[53,51,59,41],[53,66,59,56],[53,67,59,57],[54,6,60,4],[54,7,60,5],[54,16,60,14],[55,8,61,6,"setIsLoading"],[55,20,61,18],[55,21,61,19],[55,26,61,24],[55,27,61,25],[56,6,62,4],[57,4,63,2],[57,5,63,3],[58,4,65,2],[58,10,65,8,"processSessionId"],[58,26,65,24],[58,29,65,27],[58,35,65,34,"sessionId"],[58,44,65,51],[58,48,65,56],[59,6,66,4,"setIsLoading"],[59,18,66,16],[59,19,66,17],[59,23,66,21],[59,24,66,22],[60,6,67,4],[60,10,67,8],[61,8,68,6],[61,14,68,12,"response"],[61,22,68,20],[61,25,68,23],[61,31,68,29,"api"],[61,34,68,32],[61,35,68,32,"default"],[61,42,68,32],[61,43,68,33,"post"],[61,47,68,37],[61,48,68,38],[61,63,68,53],[61,65,68,55],[62,10,68,57,"session_id"],[62,20,68,67],[62,22,68,69,"sessionId"],[63,8,68,79],[63,9,68,80],[63,10,68,81],[64,8,70,6],[64,12,70,10,"response"],[64,20,70,18],[64,21,70,19,"data"],[64,25,70,23],[64,26,70,24,"success"],[64,33,70,31],[64,35,70,33],[65,10,71,8],[65,16,71,14],[66,12,71,16,"user"],[66,16,71,20],[66,18,71,22,"userData"],[66,26,71,30],[67,12,71,32,"session_token"],[68,10,71,46],[68,11,71,47],[68,14,71,50,"response"],[68,22,71,58],[68,23,71,59,"data"],[68,27,71,63],[69,10,73,8],[69,16,73,14,"AsyncStorage"],[69,28,73,26],[69,29,73,26,"default"],[69,36,73,26],[69,37,73,27,"setItem"],[69,44,73,34],[69,45,73,35],[69,60,73,50],[69,62,73,52,"session_token"],[69,75,73,65],[69,76,73,66],[70,10,74,8,"api"],[70,13,74,11],[70,14,74,11,"default"],[70,21,74,11],[70,22,74,12,"defaults"],[70,30,74,20],[70,31,74,21,"headers"],[70,38,74,28],[70,39,74,29,"common"],[70,45,74,35],[70,46,74,36],[70,61,74,51],[70,62,74,52],[70,65,74,55],[70,75,74,65,"session_token"],[70,88,74,78],[70,90,74,80],[71,10,76,8,"setUser"],[71,17,76,15],[71,18,76,16,"userData"],[71,26,76,24],[71,27,76,25],[72,10,77,8,"router"],[72,16,77,14],[72,17,77,15,"replace"],[72,24,77,22],[72,25,77,23],[72,39,77,37],[72,40,77,38],[73,8,78,6],[74,6,79,4],[74,7,79,5],[74,8,79,6],[74,15,79,13,"error"],[74,20,79,18],[74,22,79,20],[75,8,80,6,"console"],[75,15,80,13],[75,16,80,14,"error"],[75,21,80,19],[75,22,80,20],[75,48,80,46],[75,50,80,48,"error"],[75,55,80,53],[75,56,80,54],[76,8,81,6,"router"],[76,14,81,12],[76,15,81,13,"replace"],[76,22,81,20],[76,23,81,21],[76,31,81,29],[76,32,81,30],[77,6,82,4],[77,7,82,5],[77,16,82,14],[78,8,83,6,"setIsLoading"],[78,20,83,18],[78,21,83,19],[78,26,83,24],[78,27,83,25],[79,6,84,4],[80,4,85,2],[80,5,85,3],[81,4,87,2],[81,10,87,8,"login"],[81,15,87,13],[81,18,87,16,"login"],[81,19,87,16],[81,24,87,22],[82,6,88,4,"router"],[82,12,88,10],[82,13,88,11,"push"],[82,17,88,15],[82,18,88,16],[82,26,88,24],[82,27,88,25],[83,4,89,2],[83,5,89,3],[84,4,91,2],[84,10,91,8,"logout"],[84,16,91,14],[84,19,91,17],[84,25,91,17,"logout"],[84,26,91,17],[84,31,91,29],[85,6,92,4],[85,10,92,8],[86,8,93,6],[86,14,93,12,"api"],[86,17,93,15],[86,18,93,15,"default"],[86,25,93,15],[86,26,93,16,"post"],[86,30,93,20],[86,31,93,21],[86,45,93,35],[86,46,93,36],[87,6,94,4],[87,7,94,5],[87,8,94,6],[87,15,94,13,"error"],[87,20,94,18],[87,22,94,20],[88,8,95,6,"console"],[88,15,95,13],[88,16,95,14,"log"],[88,19,95,17],[88,20,95,18],[88,39,95,37],[88,41,95,39,"error"],[88,46,95,44],[88,47,95,45],[89,6,96,4],[90,6,98,4],[90,12,98,10,"AsyncStorage"],[90,24,98,22],[90,25,98,22,"default"],[90,32,98,22],[90,33,98,23,"removeItem"],[90,43,98,33],[90,44,98,34],[90,59,98,49],[90,60,98,50],[91,6,99,4],[91,13,99,11,"api"],[91,16,99,14],[91,17,99,14,"default"],[91,24,99,14],[91,25,99,15,"defaults"],[91,33,99,23],[91,34,99,24,"headers"],[91,41,99,31],[91,42,99,32,"common"],[91,48,99,38],[91,49,99,39],[91,64,99,54],[91,65,99,55],[92,6,100,4,"setUser"],[92,13,100,11],[92,14,100,12],[92,18,100,16],[92,19,100,17],[93,6,101,4,"router"],[93,12,101,10],[93,13,101,11,"replace"],[93,20,101,18],[93,21,101,19],[93,29,101,27],[93,30,101,28],[94,4,102,2],[94,5,102,3],[95,4,104,2],[95,24,105,4],[95,28,105,4,"_reactJsxDevRuntime"],[95,47,105,4],[95,48,105,4,"jsxDEV"],[95,54,105,4],[95,56,105,5,"AuthContext"],[95,67,105,16],[95,68,105,17,"Provider"],[95,76,105,25],[96,6,105,26,"value"],[96,11,105,31],[96,13,105,33],[97,8,105,35,"user"],[97,12,105,39],[98,8,105,41,"isLoading"],[98,17,105,50],[99,8,105,52,"login"],[99,13,105,57],[100,8,105,59,"logout"],[100,14,105,65],[101,8,105,67,"processSessionId"],[102,6,105,84],[102,7,105,86],[103,6,105,86,"children"],[103,14,105,86],[103,16,106,7,"children"],[104,4,106,15],[105,6,106,15,"fileName"],[105,14,106,15],[105,16,106,15,"_jsxFileName"],[105,28,106,15],[106,6,106,15,"lineNumber"],[106,16,106,15],[107,6,106,15,"columnNumber"],[107,18,106,15],[108,4,106,15],[108,11,107,26],[108,12,107,27],[109,2,109,0],[110,2,111,7],[110,11,111,16,"useAuth"],[110,18,111,23,"useAuth"],[110,19,111,23],[110,21,111,26],[111,4,112,2],[111,10,112,8,"context"],[111,17,112,15],[111,20,112,18],[111,24,112,18,"useContext"],[111,30,112,28],[111,31,112,28,"useContext"],[111,41,112,28],[111,43,112,29,"AuthContext"],[111,54,112,40],[111,55,112,41],[112,4,113,2],[112,8,113,6,"context"],[112,15,113,13],[112,20,113,18,"undefined"],[112,29,113,27],[112,31,113,29],[113,6,114,4],[113,12,114,10],[113,16,114,14,"Error"],[113,21,114,19],[113,22,114,20],[113,67,114,65],[113,68,114,66],[114,4,115,2],[115,4,116,2],[115,11,116,9,"context"],[115,18,116,16],[116,2,117,0],[117,0,117,1],[117,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","checkAuth","processSessionId","login","logout","useAuth"],"mappings":"AAA;OCuB;YCM;GDE;YCE;GDU;oBEE;GFiB;2BGE;GHoB;gBIE;GJE;iBKE;GLW;CDO;OOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}